package dev.guinness.client.module.modules.exploit;

import net.minecraftforge.fml.common.eventhandler.SubscribeEvent;
import net.minecraft.network.play.client.CPacketEntityAction;
import dev.guinness.client.mixin.mixins.IPlayerControllerMP;
import dev.guinness.client.mixin.mixins.ICPacketPlayer;
import net.minecraft.network.play.client.CPacketPlayer;
import dev.guinness.client.event.events.PacketEvent$PacketSendEvent;
import dev.guinness.client.module.Category;
import dev.guinness.client.module.Module;

public class AntiHunger extends Module
{
    public AntiHunger() {
        super("AntiHunger", Category.EXPLOIT, "Minimizes hunger taken from sprinting");
    }
    
    @SubscribeEvent
    public void onPacketSendEvent(final PacketEvent$PacketSendEvent packetEvent$PacketSendEvent) {
        if (packetEvent$PacketSendEvent.getPacket() instanceof CPacketPlayer) {
            final CPacketPlayer packet = (CPacketPlayer)packetEvent$PacketSendEvent.getPacket();
            ((ICPacketPlayer)packet).setOnGround(AntiHunger.mc.player.field_70143_R > Float.intBitsToFloat(Float.floatToIntBits(3.0528842E38f) ^ 0x7F65AC69) || ((IPlayerControllerMP)AntiHunger.mc.playerController).isHittingBlock());
        }
        if (packetEvent$PacketSendEvent.getPacket() instanceof CPacketEntityAction) {
            final CPacketEntityAction packet2 = (CPacketEntityAction)packetEvent$PacketSendEvent.getPacket();
            if (packet2.getAction() == CPacketEntityAction.Action.START_SPRINTING || packet2.getAction() == CPacketEntityAction.Action.STOP_SPRINTING) {
                packetEvent$PacketSendEvent.setCanceled(true);
            }
        }
    }
}
